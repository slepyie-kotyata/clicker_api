# Click & Cook – Бэкэнд

**clicker_api** — это API для браузерной кликер-игры **Click & Cook**.

## Описание

Этот репозиторий содержит серверную часть для веб-игры-кликера, разработанную на языке Go. 
API предоставляет необходимые эндпоинты для работы с игрой: регистрация\авторизация пользователей, обработка кликов, создание сессий, прокачка, уровни и сохранение прогресса.

## Стэк технологий

- **Go** — основной язык разработки backend сервиса
- **Echo/Gorilla** — веб-фреймворки для реализации REST API
- **Gorilla WebSocket** — библиотека для работы с WebSocket-соединениями
- **PostgreSQL** — реляционная база данных для хранения данных пользователей и прогресса
- **JWT** — аутентификация и авторизация пользователей
- **CORS** — защита от неавторизованных кросс-доменных запросов

## Быстрый старт

1. Клонируйте репозиторий:
   ```
   git clone https://github.com/slepyie-kotyata/clicker_api.git
   ```
2. Перейдите в папку проекта:
   ```
   cd clicker_api
   ```
3. Соберите и запустите сервер:
   ```
   go build
   ./clicker_api
   ```

## Документация API

### Аутентификация и регистрация

- **POST /reg**  
  Регистрация нового пользователя и получение access/refresh токенов.

- **POST /auth**  
  Аутентификация пользователя и получение access/refresh токенов.

---

### Игровые сессии

- **GET /game/sessions**  
  Получить или инициализировать игровую сессию пользователя.

- **PATCH /game/sessions/cook**  
  Приготовлениеь блюда — увеличивает количество блюд и опыт.

- **PATCH /game/sessions/sell**  
  Продажа приготовленных блюд — увеличивает количество денег опыта и убавляет блюда.

- **PATCH /game/sessions/reset**  
  Сброс сессии до нулевого состояния, активация бонуса престижа

---

### Прогресс и уровни

- **GET /game/levels**  
  Получить текущий уровень и опыт пользователя, а также опыт, необходимый для следующего уровня.

- **PATCH /game/levels**  
  Повысить уровень если достаточное количество опыта.

---

### Прокачка и апгрейды

- **GET /game/upgrades**  
  Получить список доступных для покупки апгрейдов.

- **PATCH /game/upgrades/:upgrade_id**  
  Купить апгрейд.

---

### Обновление токенов

- **POST /refresh**  
  Получить новый access токен по refresh токену.

---

### Веб-сокеты

- **GET /passive/?token=**  
  WebSocket-соединение для пассивного режима (автоматическое приготовление/продажа блюд, обновление состояния сессии в реальном времени).

---

> Для всех эндпоинтов, кроме /reg и /auth, требуется передавать JWT Access Token в заголовке авторизации. Для эндпоинта /passive JWT Access Token передаётся не в заголовке, а как query-параметр.
